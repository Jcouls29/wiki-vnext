# ===============================================
# STORAGE
# ===============================================

extend type Query {
  storageTargets: [StorageTarget] @auth(requires: ["manage:system"])
  storageStatus: [StorageStatus] @auth(requires: ["manage:system"])
}

extend type Mutation {
  updateStorageTargets(
    targets: [StorageTargetInput]!
  ): DefaultResponse @auth(requires: ["manage:system"])

  executeStorageAction(
    targetKey: String!
    handler: String!
  ): DefaultResponse @auth(requires: ["manage:system"])
}

# -----------------------------------------------
# TYPES
# -----------------------------------------------

type StorageTarget {
  id: UUID
  isEnabled: Boolean
  module: String
  title: String
  description: String
  logo: String
  website: String
  contentTypes: [String]
  supportedModes: [String]
  mode: String
  hasSchedule: Boolean!
  syncInterval: String
  syncIntervalDefault: String
  config: [KeyValuePair]
  actions: [StorageTargetAction]
}

input StorageTargetInput {
  isEnabled: Boolean!
  key: String!
  mode: String!
  syncInterval: String
  config: [KeyValuePairInput]
}

type StorageStatus {
  key: String!
  title: String!
  status: String!
  message: String!
  lastAttempt: String!
}

type StorageTargetAction {
  handler: String!
  label: String!
  hint: String!
}
